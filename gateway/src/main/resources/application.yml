# API Gateway Configuration
#
# EDUCATIONAL NOTE - Spring Cloud Gateway
#
# Spring Cloud Gateway uses a reactive programming model (WebFlux).
# Routes are defined declaratively in this YAML file.
#
# Each route has:
# - id: Unique identifier for the route
# - uri: Destination service URL
# - predicates: Conditions to match (e.g., path pattern)
# - filters: Modifications to request/response (optional)

server:
  port: 8080  # Gateway runs on port 8080 (standard HTTP port alt)

spring:
  application:
    name: gateway
  
  cloud:
    gateway:
      routes:
        # Route 1: Auth Service
        # All requests starting with /api/v1/auth go to auth-service
        - id: auth-service
          uri: http://localhost:8081
          predicates:
            - Path=/api/v1/auth/**
        
        # Route 2: Account Service  
        # All requests starting with /api/v1/accounts go to account-service
        - id: account-service
          uri: http://localhost:8082
          predicates:
            - Path=/api/v1/accounts/**

logging:
  level:
    org.springframework.cloud.gateway: DEBUG
    reactor.netty: INFO

# EDUCATIONAL NOTE - How Routing Works
#
# Example request: POST http://localhost:8080/api/v1/auth/register
#
# 1. Gateway receives the request on port 8080
# 2. Checks predicates: Path=/api/v1/auth/** matches!
# 3. Routes to: http://localhost:8081/api/v1/auth/register
# 4. Auth service processes the request
# 5. Response flows back through gateway to client
#
# The client doesn't know (or care) that auth-service is on port 8081.
# They only know the gateway at port 8080.
